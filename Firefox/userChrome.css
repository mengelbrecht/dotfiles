@namespace url("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul");
@namespace html url("http://www.w3.org/1999/xhtml");

/**********************************************************************************************************************/

/* Variables to modify the style */

/*
 * Colors from https://flatuicolors.com/palette/de
 */

:root {
  --mod-color-blue: #4b7bec;
  --mod-color-green: #20bf6b;
  --mod-accent-color: var(--mod-color-blue);
  --mod-url-font: "Iosevka";
}

/**********************************************************************************************************************/

/* Remove line above tabs */

.tab-line {
  display: none !important;
}

/**********************************************************************************************************************/

/* Hide titlebar placeholders and buttons */

.titlebar-placeholder[type="pre-tabs"] {
  width: 14px !important;
}

.titlebar-placeholder[type="post-tabs"] {
  display: none !important;
}

/**********************************************************************************************************************/

/* Move the "title changed" notification dot on pinned tabs to the upper right and restyle it */

.tab-content[pinned][attention]:not([selected]),
.tab-content[pinned][titlechanged]:not([selected]),
.tab-content[attention]:not([selected]) {
  /* Context variables do not seem to work in embedded svg files */
  background-image: url('data:image/svg+xml;utf8,<svg viewBox="0 0 10 10" width="5" height="5" xmlns="http://www.w3.org/2000/svg"><circle cx="5" cy="5" r="5" fill="%234b7bec"/></svg>') !important;
  background-position: top 3px right 3px !important;
}

/**********************************************************************************************************************/

/* Let new tab button fill the right side of the tabbar. */

.tabs-newtab-button .toolbarbutton-icon,
#new-tab-button .toolbarbutton-icon {
  margin-left: -1px !important;
  border-radius: 0px !important;
  /* Make the icon a little smaller */
  padding: 9px !important;
}

/**********************************************************************************************************************/

/* Let all tabs tab button fill the right side of the tabbar. */

#alltabs-button {
  padding: 0 !important;
}

#alltabs-button .toolbarbutton-icon {
  border-radius: 0px !important;
}

/**********************************************************************************************************************/

/* Decrease height of side borders to prevent overlap */

.tabbrowser-tab::before,
.tabbrowser-tab::after {
  margin-bottom: 1px !important;
}

/**********************************************************************************************************************/

/*
 * Only show tab close button on hover
 * https://www.reddit.com/r/FirefoxCSS/comments/7faicl/any_way_to_hide_close_tab_button_until_you_hover
 */

.tabbrowser-tab:not([pinned]) .tab-close-button {
  transition: opacity 200ms !important;
}

.tabbrowser-tab:not([pinned]):not([hover]) .tab-close-button {
  opacity: 0 !important;
  width: 0 !important;
  overflow: hidden;
}

.tabbrowser-tab:not([pinned]):hover .tab-close-button {
  opacity: 1 !important;
  width: auto !important;
}

/**********************************************************************************************************************/

/* Make tab close icon smaller */

.tabbrowser-tab:not([pinned]) .tab-close-button {
  width: 14px !important;
  height: 14px !important;
}

/**********************************************************************************************************************/

/* Change color of tab loading indicator to accent color */

:root {
  --tab-loading-fill: var(--mod-accent-color) !important;
}

.tab-throbber::before {
  fill: var(--mod-accent-color) !important;
  opacity: 1 !important;
}

/**********************************************************************************************************************/

/*
 * Remove shadow on tabs scroll icons
 * https://github.com/Maxmel/dotfiles/blob/81ea2120e2da313431d3417327cf57a8a7fe5b68/userChrome.css#L226
 */

.tabbrowser-arrowscrollbox > .arrowscrollbox-overflow-start-indicator:not([collapsed]),
.tabbrowser-arrowscrollbox > .arrowscrollbox-overflow-end-indicator:not([collapsed]) {
  background: none !important;
  border: none !important;
}

/**********************************************************************************************************************/

/* Move menu button to the left */

#PanelUI-button {
  -moz-box-ordinal-group: 0 !important;
  /* Remove separator before menu button */
  border-inline-start: 0px !important;
}

/**********************************************************************************************************************/

/* Hide page action button */

#pageActionButton {
  display: none;
}

/**********************************************************************************************************************/

/*
 * Change urlbar selection colors
 * https://www.reddit.com/r/FirefoxCSS/comments/7lqhkg/url_bar_highlight
 */

:root {
  --chrome-selection-color: black !important;
  --chrome-selection-background-color: rgb(179, 216, 253) !important;
}

:root:-moz-lwtheme-brighttext {
  --chrome-selection-color: #fff !important;
  --chrome-selection-background-color: #5675b9 !important;
}

/**********************************************************************************************************************/

/* Remove shadows from urlbar */

#urlbar,
#urlbar:hover {
  box-shadow: none !important;
}

/**********************************************************************************************************************/

/* Increase margin of urlbar */

#urlbar,
#main-window #nav-bar #PlacesToolbar {
  margin-top: 4px !important;
  margin-bottom: 4px !important;
}

/**********************************************************************************************************************/

/* Make focused urlbar border thinner */

#urlbar:hover[focused],
#urlbar[focused] {
  border: 1px solid var(--mod-accent-color) !important;
}

/**********************************************************************************************************************/

/* Use custom font for urls */

.urlbar-input-box,
.autocomplete-richlistitem .ac-url,
statuspanel[type="overLink"] {
  font-family: var(--mod-url-font) !important;
}

/* Shrink navbar url font size a little */

.urlbar-input-box {
  font-size: 13px !important;
}

/* Slightly increase statuspanel url font size */

statuspanel[type="overLink"] {
  font-size: 13px !important;
}

/**********************************************************************************************************************/

/* Change color of secure connection icon */

#urlbar[pageproxystate="valid"] > #identity-box.verifiedDomain > #connection-icon,
#urlbar[pageproxystate="valid"] > #identity-box.mixedActiveBlocked > #connection-icon,
#identity-popup[connection^="secure"] .identity-popup-security-content {
  fill: var(--mod-color-green) !important;
}

.identity-popup-connection-secure {
  color: var(--mod-color-green) !important;
}

/**********************************************************************************************************************/

/*
 * Hide the identity label and the separator if the identity is verified.
 * Instead, use blue for the connection icon instead of green to signal that the identity is verified.
 */

/* Hide separator in urlbar */

#urlbar[pageproxystate="valid"] > #identity-box.verifiedIdentity,
#urlbar[pageproxystate="valid"] > #identity-box.chromeUI,
#urlbar[pageproxystate="valid"] > #identity-box.extensionPage {
  padding-inline-end: 4px !important;
  margin-inline-end: 4px !important;
  border-inline-end: none !important;
}

/* Hide identity label */

#identity-icon-labels {
  display: none !important;
}

/* Highlight connection icon in blue if identity is verified */

#urlbar[pageproxystate="valid"] > #identity-box.verifiedIdentity > #connection-icon {
  fill: var(--mod-color-blue) !important;
}

/**********************************************************************************************************************/

/* Only show page actions on hover */

#urlbar-container:not(:hover) #urlbar:not([focused]) #page-action-buttons {
  opacity: 0 !important;
  transition: opacity 150ms ease !important;
}

#urlbar-container:hover #page-action-buttons {
  opacity: 1 !important;
  transition: opacity 150ms ease !important;
}

/**********************************************************************************************************************/

/* Shrink tab bar height  */

:root[uidensity="compact"] #tabbrowser-tabs {
  --tab-min-height: 26px !important;
}

.tabbrowser-tab {
  max-height: 25px !important;
}

#TabsToolbar {
  max-height: 25px !important;
}

/* Adjust new tab button for smaller tabbar height */

.tabs-newtab-button .toolbarbutton-icon,
#new-tab-button .toolbarbutton-icon {
  padding: 8px 10px 8px 9px !important;
  margin-bottom: -1px !important;
}

/* Align titlebar buttons in the center due to reduced height */

#titlebar-buttonbox {
  margin-top: -4px;
}

/**********************************************************************************************************************/

/*
 * Remove 'dragging tab' margin/padding nonsense
 * https://github.com/Aris-t2/CustomCSSforFx/blob/8a63f3cea254abdfcfaf90de4684a33181775747/classic/css/tabs/tabs_below_navigation_toolbar.css#L214
 */

#TabsToolbar[movingtab] > #tabbrowser-tabs {
  padding-bottom: unset !important;
  margin-bottom: unset !important;
}

#TabsToolbar[movingtab] + #nav-bar {
  margin-top: unset !important;
}

/**********************************************************************************************************************/

/* Use grayscale favicons for not hovered/selected tabs */

.tabbrowser-tab .tab-icon-image {
  filter: grayscale(100%) !important;
  transition: filter 200ms !important;
}

.tabbrowser-tab:hover .tab-icon-image,
.tabbrowser-tab[selected] .tab-icon-image {
  filter: none !important;
}
